<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Services</title>
    <link rel="stylesheet" href="./css/services.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <!-- Your existing HTML structure remains the same -->
    
    <script>
        // Define base API URL (now using port 10000)
        const API_BASE_URL = 'http://localhost:10000';
        
        // Fetch header text from the backend
        function fetchHeaderText() {
            fetch(`${API_BASE_URL}/api/content/header`)  // Updated endpoint
                .then(response => response.json())
                .then(data => {
                    if (data.headerText) {
                        document.getElementById("services-header-title").textContent = data.headerText;
                    }
                })
                .catch(error => console.error("Error fetching header text:", error));
        }

        // Fetch all services
        function fetchServices() {
            fetch(`${API_BASE_URL}/api/services`)  // This endpoint was correct
                .then(response => response.json())
                .then(data => {
                    if (!Array.isArray(data)) throw new Error("Received data is not an array");
                    
                    const servicesContainer = document.getElementById("services-container");
                    servicesContainer.innerHTML = "";

                    data.forEach(service => {
                        const serviceCard = document.createElement("div");
                        serviceCard.classList.add("service-card");

                        // Handle Image & Video Rendering
                        const imageHTML = service.image ? `<img src="${API_BASE_URL}/${service.image}" alt="${service.title}" />` : '';
                        const videoHTML = service.video ? `<video width="320" height="240" controls>
                                                            <source src="${API_BASE_URL}/${service.video}" type="video/mp4">
                                                            Your browser does not support the video tag.
                                                        </video>` : '';
                        
                        serviceCard.innerHTML = ` 
                            <h2>${service.title}</h2>
                            <p>${service.description}</p>
                            ${imageHTML}
                            ${videoHTML}
                        `;
                        servicesContainer.appendChild(serviceCard);
                    });
                })
                .catch(error => console.error("Error fetching services:", error));
        }

        // Fetch the footer content from the backend
        function fetchFooter() {
            fetch(`${API_BASE_URL}/api/content/footer`)  // This endpoint was correct
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Error: ${response.status} - ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(data => {
                    const footerText = data.footerText;
                    const footerContainer = document.querySelector("footer .container");
                    footerContainer.innerHTML = `<p>${footerText}</p>`;
                })
                .catch(error => {
                    console.error("Error fetching footer:", error);
                });
        }

        // Call fetchFooter, fetchHeaderText, and fetchServices on page load
        window.onload = function() {
            fetchHeaderText();
            fetchServices();
            fetchFooter();
        };
    </script>
</body>
</html>