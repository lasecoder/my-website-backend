<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FutureTechTalent - Business Solutions</title>
    <link rel="stylesheet" href="./css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://kit.fontawesome.com/a033fa8b24.js" crossorigin="anonymous"></script>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-left">
                <img id="logo" src="" alt="Company Logo">
            </div>
            <div class="register">
                <button class="btn" onclick="location.href='login.html'">Login</button>
                <button class="btn" onclick="location.href='signup.html'">Sign Up</button>
            </div>
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Search..." />
                <button onclick="searchFunction()">üîç</button>
            </div>
            <div class="header-right">
                <nav>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="services.html">Services</a></li>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="vacancy.html">Vacancy</a></li>
                        <li><a href="scholars.html">Scholarship</a></li>
                        <li><a href="contact.html">Contact</a></li>
                        <li><a href="about.html">About Us</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Header Content Section -->
        <section class="content-section" id="header-section">
            <h2>Loading header...</h2>
        </section>

        <!-- Services Content Section -->
        <section class="content-section" id="services-section">
            <h2>Our Services</h2>
            <div id="services-container"></div>
        </section>

        <!-- Footer Content Section -->
        <footer class="content-section" id="footer-section">
            <p>Loading footer...</p>
        </footer>

        <!-- Chat Bot -->
        <div id="chat-bot">
            <button id="chat-toggle">üí¨ Chat with Us</button>
            <div id="chat-window" style="display:none;">
                <div id="chat-messages"></div>
                <input type="text" id="chat-input" placeholder="Type your message...">
                <button id="send-button">Send</button>
            </div>
        </div>
    </main>

    <script>
        const backendUrl = "https://my-backend-service.onrender.com";
    
        // 1. First define the utility function
        async function fetchWithCORS(url, options = {}) {
            try {
                const response = await fetch(url, {
                    ...options,
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error(`Fetch error for ${url}:`, error);
                throw error;
            }
        }
    
        // 2. Then define all fetch functions
        async function fetchHeader() {
            try {
                const headerData = await fetchWithCORS(`${backendUrl}/api/header`);
                
                const headerSection = document.getElementById('header-section');
                if (headerData.logoUrl) {
                    document.getElementById('logo').src = `${backendUrl}${headerData.logoUrl}`;
                }
                
                headerSection.innerHTML = `
                    <h2>${headerData.title || 'Welcome to FutureTechTalent'}</h2>
                    ${headerData.description ? `<p>${headerData.description}</p>` : ''}
                    ${headerData.image ? `<img src="${backendUrl}${headerData.image}" alt="Header Image" style="max-width:100%;">` : ''}
                `;
            } catch (error) {
                console.error('Error fetching header:', error);
                document.getElementById('header-section').innerHTML = `
                    <h2>Welcome to FutureTechTalent</h2>
                    <p>Your trusted partner for business solutions</p>
                `;
            }
        }
    
        async function fetchServices() {
            try {
                const services = await fetchWithCORS(`${backendUrl}/api/services`);
                const servicesContainer = document.getElementById('services-container');
                
                if (services.length === 0) {
                    servicesContainer.innerHTML = '<p>No services available at the moment.</p>';
                    return;
                }
                
                servicesContainer.innerHTML = '';
                services.forEach(service => {
                    const serviceCard = document.createElement('div');
                    serviceCard.className = 'service-card';
                    serviceCard.innerHTML = `
                        <h3>${service.title || 'Service'}</h3>
                        <p>${service.description || ''}</p>
                        ${service.image ? `<img src="${backendUrl}${service.image}" alt="${service.title || 'Service Image'}">` : ''}
                        ${service.video ? `<video src="${backendUrl}${service.video}" controls style="max-width:100%;"></video>` : ''}
                    `;
                    servicesContainer.appendChild(serviceCard);
                });
            } catch (error) {
                console.error('Error fetching services:', error);
                document.getElementById('services-container').innerHTML = `
                    <div class="service-card">
                        <h3>AI Strategy</h3>
                        <p>Let us help you adopt AI solutions for your business</p>
                    </div>
                    <div class="service-card">
                        <h3>Cloud Migration</h3>
                        <p>Move your business to the cloud seamlessly</p>
                    </div>
                `;
            }
        }
    
        async function fetchFooter() {
            try {
                const footerData = await fetchWithCORS(`${backendUrl}/api/content/footer`);
                const footerSection = document.getElementById('footer-section');
                
                footerSection.innerHTML = `
                    <p>${footerData.footerText || '¬© 2025 FutureTechTalent. All rights reserved.'}</p>
                `;
            } catch (error) {
                console.error('Error fetching footer:', error);
                document.getElementById('footer-section').innerHTML = `
                    <p>¬© 2025 FutureTechTalent. All rights reserved.</p>
                `;
            }
        }
    
        function initChat() {
            const toggleBtn = document.getElementById('chat-toggle');
            const chatWindow = document.getElementById('chat-window');
            
            toggleBtn.addEventListener('click', () => {
                chatWindow.style.display = chatWindow.style.display === 'none' ? 'block' : 'none';
            });
            
            document.getElementById('send-button').addEventListener('click', sendMessage);
            
            function sendMessage() {
                const input = document.getElementById('chat-input');
                const message = input.value.trim();
                if (message) {
                    const messagesDiv = document.getElementById('chat-messages');
                    messagesDiv.innerHTML += `<p><strong>You:</strong> ${message}</p>`;
                    input.value = '';
                    
                    setTimeout(() => {
                        messagesDiv.innerHTML += `<p><strong>Support:</strong> Thanks for your message! We'll get back to you soon.</p>`;
                    }, 1000);
                }
            }
        }
    
        // 3. Finally, initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            fetchHeader();
            fetchServices();
            fetchFooter();
            initChat();
        });
    </script>
</body>
</html>